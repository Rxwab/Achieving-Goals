<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø±Ø­Ù„Ø© Ù†Ø¬Ø§Ø­ - Ù…Ø¯ÙŠØ± Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„ØªØ­ÙÙŠØ²</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script type="module">
        // Firebase Imports (Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // setLogLevel('debug'); // ÙŠÙ…ÙƒÙ† ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„ØªØµØ­ÙŠØ­ Ù‡Ù†Ø§

        // General Firebase variables
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'rehlah-nagah-default';

        let db = null;
        let auth = null;
        let userId = null;

        const EGYPT_TIMEZONE = 'Africa/Cairo';
        const EXAM_DATE = new Date(new Date().getFullYear() + 1, 0, 15); // 15 ÙŠÙ†Ø§ÙŠØ±

        // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø±ÙˆØ³ ÙˆÙ†Ù‚Ø§Ø·Ù‡Ø§ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ© (Ø¥Ø¬Ù…Ø§Ù„ÙŠ 110 Ù†Ù‚Ø·Ø© = 280 Ø¯Ø±Ø¬Ø© Ù‡Ø¯Ù)
        const FULL_LESSONS_LIST = {
            'Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©': [ // 40 Ù†Ù‚Ø·Ø©
                { lesson: 'Ø§Ù„Ù†ØµÙˆØµ (Ø³ÙÙŠÙ†Ø© Ù†ÙˆØ­)', points: 7 }, 
                { lesson: 'Ø§Ù„Ù†Ø­Ùˆ (Ø§Ù„Ù…Ù†Ø§Ø¯Ù‰)', points: 7 }, 
                { lesson: 'Ø§Ù„Ù†ØµÙˆØµ (Ø¹Ø¨Ø§Ø¯ Ø§Ù„Ø±Ø­Ù…Ù†)', points: 7 }, 
                { lesson: 'Ø§Ù„Ù†Ø­Ùˆ (Ø§Ù„Ø¨Ø¯Ù„)', points: 7 }, 
                { lesson: 'Ù‚ØµØ© (Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„)', points: 6 }, 
                { lesson: 'Ù‚ØµØ© (Ø§Ù„ÙØµÙ„ Ø§Ù„Ø«Ø§Ù†ÙŠ)', points: 6 } 
            ], 
            'Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©': [ // 30 Ù†Ù‚Ø·Ø©
                { lesson: 'Unit 1: Personal Identity', points: 5 }, 
                { lesson: 'Unit 2: Communication', points: 5 }, 
                { lesson: 'Unit 3: AI', points: 5 }, 
                { lesson: 'Unit 4: Screen Time', points: 5 }, 
                { lesson: 'Unit 5: Design Thinking', points: 5 }, 
                { lesson: 'Unit 6: Why Do We Like Stories?', points: 5 } 
            ], 
            'Ø§Ù„Ø¹Ù„ÙˆÙ…': [ // 20 Ù†Ù‚Ø·Ø©
                { lesson: 'Ø§Ù„ÙˆØ­Ø¯Ø© 1: Ø§Ù„Ù‚ÙˆÙ‰ ÙˆØ§Ù„Ø­Ø±ÙƒØ©', points: 4 }, 
                { lesson: 'Ø§Ù„ÙˆØ­Ø¯Ø© 2: Ø§Ù„Ù…Ø±Ø§ÙŠØ§ ÙˆØ§Ù„Ø¹Ø¯Ø³Ø§Øª', points: 4 }, 
                { lesson: 'Ø§Ù„ÙˆØ­Ø¯Ø© 3: Ø§Ù„ÙƒÙˆÙ† ÙˆØ§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ù…Ø³ÙŠ', points: 4 }, 
                { lesson: 'Ø§Ù„ÙˆØ­Ø¯Ø© 4: Ø§Ù„Ø§Ù†Ù‚Ø³Ø§Ù… Ø§Ù„Ø®Ù„ÙˆÙŠ', points: 4 }, 
                { lesson: 'Ø§Ù„ÙˆØ­Ø¯Ø© 4: Ø§Ù„ØªÙƒØ§Ø«Ø± ÙˆØ§Ø³ØªÙ…Ø±Ø§Ø± Ø§Ù„Ù†ÙˆØ¹', points: 4 } 
            ], 
            'Ø§Ù„Ø¯Ø±Ø§Ø³Ø§Øª Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©': [ // 20 Ù†Ù‚Ø·Ø©
                { lesson: 'Ø¬ØºØ±Ø§ÙÙŠØ§ (Ùˆ1: Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠØ§ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© Ù„Ù„Ø¹Ø§Ù„Ù…)', points: 5 }, 
                { lesson: 'Ø¬ØºØ±Ø§ÙÙŠØ§ (Ùˆ2: Ø³ÙƒØ§Ù† Ø§Ù„Ø¹Ø§Ù„Ù…)', points: 5 }, 
                { lesson: 'ØªØ§Ø±ÙŠØ® (Ùˆ3: Ù…ØµØ± ØªØ­Øª Ø§Ù„Ø­ÙƒÙ… Ø§Ù„Ø¹Ø«Ù…Ø§Ù†ÙŠ)', points: 5 }, 
                { lesson: 'ØªØ§Ø±ÙŠØ® (Ùˆ4: Ø§Ù„Ø²Ø­Ù Ø§Ù„Ø§Ø³ØªØ¹Ù…Ø§Ø±ÙŠ)', points: 5 } 
            ]
            // **Ù…Ù„Ø§Ø­Ø¸Ø©: ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ù…Ø§Ø¯Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø·Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø®ÙŠØ±.**
        };
        const TOTAL_MAX_SCORE = 110; // Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠØ© (40+30+20+20 = 110)

        const STATE = {
            isAuthReady: false,
            currentAfirPoints: 0,
            studyTimeToday: 0, // In seconds
            lastScheduleDate: null, 
            timer: {
                isRunning: false,
                isStudyMode: true, 
                duration: 50 * 60, 
                remaining: 50 * 60,
                intervalId: null
            },
            schedule: {
                sleep: '22:00', // 10 PM
                business: '15:00', // 3 PM
                play: '14:00', // 2 PM
                studyStart: '18:00', // 6 PM
                studyEnd: '21:00', // 9 PM
            },
            lessonsCompletionStatus: {}, 
            dailyTasks: [] 
        };

        // Initialize completion status
        Object.keys(FULL_LESSONS_LIST).forEach(subject => {
            FULL_LESSONS_LIST[subject].forEach(item => {
                const key = `${subject}:${item.lesson}`;
                if (STATE.lessonsCompletionStatus[key] === undefined) {
                    STATE.lessonsCompletionStatus[key] = {
                        completed: false,
                        points: item.points
                    };
                }
            });
        });


        const DATA_COLLECTION = 'rehlah_nagah_data_v3'; 
        const DATA_DOC = 'user_profile';

        // --- Firebase Core Functions ---

        async function initializeFirebase() {
            try {
                if (!firebaseConfig || Object.keys(firebaseConfig).length === 0) {
                    console.error("Firebase config is missing.");
                    return;
                }
                const app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);

                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }

                onAuthStateChanged(auth, (user) => {
                    if (user) {
                        userId = user.uid;
                        STATE.isAuthReady = true;
                        startDataListener();
                    } else {
                        console.log("No user signed in.");
                    }
                });

            } catch (error) {
                console.error("Firebase initialization or authentication failed:", error);
            }
        }

        function getDocRef() {
            if (!db || !userId) {
                console.error("Database or User ID is not ready.");
                return null;
            }
            return doc(db, 'artifacts', appId, 'users', userId, DATA_COLLECTION, DATA_DOC);
        }

        function startDataListener() {
            if (!db || !userId) return;

            const docRef = getDocRef();
            if (!docRef) return; 

            onSnapshot(docRef, (docSnap) => {
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    STATE.currentAfirPoints = data.currentAfirPoints || 0;
                    STATE.studyTimeToday = data.studyTimeToday || 0;
                    STATE.lessonsCompletionStatus = { ...STATE.lessonsCompletionStatus, ...data.lessonsCompletionStatus };
                    STATE.schedule = data.schedule || STATE.schedule;
                    STATE.lastScheduleDate = data.lastScheduleDate;
                    STATE.dailyTasks = data.dailyTasks || [];

                    checkAndGenerateDailyTasks();
                } else {
                    saveData();
                }
                updateUI();
            }, (error) => {
                console.error("Error listening to data:", error);
            });
        }

        async function saveData() {
            if (!db || !userId) return;
            const docRef = getDocRef();
            if (!docRef) return; 
            try {
                await setDoc(docRef, {
                    currentAfirPoints: STATE.currentAfirPoints,
                    studyTimeToday: STATE.studyTimeToday,
                    lessonsCompletionStatus: STATE.lessonsCompletionStatus,
                    schedule: STATE.schedule,
                    lastScheduleDate: STATE.lastScheduleDate,
                    dailyTasks: STATE.dailyTasks,
                    lastUpdated: new Date().toISOString(),
                    userId: userId,
                }, { merge: true });
            } catch (error) {
                console.error("Error saving data:", error);
            }
        }
        
        // --- Audio Functions ---
        function playSound(soundFile) {
            // Ù…Ù„Ø§Ø­Ø¸Ø©: ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…Ù„Ù Ø§Ù„ØµÙˆØª (Ù…Ø«Ù„ 'alert.mp3') Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹ ÙÙŠ Ù…Ø¬Ù„Ø¯ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹.
            const audio = new Audio(soundFile);
            audio.play().catch(e => console.error("Could not play sound:", e));
        }

        // --- Daily Task Generation Logic (Finish in 30 Days) ---
        
        function getFormattedDate(date) {
            return date.toLocaleDateString('en-CA', { timeZone: EGYPT_TIMEZONE });
        }

        function checkAndGenerateDailyTasks() {
            const nowEgypt = new Date().toLocaleString("en-US", { timeZone: EGYPT_TIMEZONE });
            const todayFormatted = getFormattedDate(new Date(nowEgypt));

            if (STATE.lastScheduleDate !== todayFormatted) {
                STATE.studyTimeToday = 0; 
            }

            if (STATE.lastScheduleDate !== todayFormatted || STATE.dailyTasks.length === 0) {
                
                const allUncompletedLessons = [];
                Object.keys(STATE.lessonsCompletionStatus).forEach(key => {
                    if (!STATE.lessonsCompletionStatus[key].completed) {
                        const [subject, lesson] = key.split(':');
                        allUncompletedLessons.push({ subject, lesson, id: key, points: STATE.lessonsCompletionStatus[key].points });
                    }
                });
                
                const targetTasks = 2; // Target 2 new lessons per day
                STATE.dailyTasks = [];
                
                allUncompletedLessons.sort(() => Math.random() - 0.5); 

                for (let i = 0; i < Math.min(targetTasks, allUncompletedLessons.length); i++) {
                    const lesson = allUncompletedLessons[i];
                    STATE.dailyTasks.push({
                        id: lesson.id,
                        subject: lesson.subject,
                        lesson: lesson.lesson,
                        isCompleted: false 
                    });
                }
                
                // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø£ÙŠ Ø¯Ø±ÙˆØ³ Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ù…ØªØ¨Ù‚ÙŠØ© (21 Ø¯Ø±Ø³ ØªÙ… Ø¥ÙƒÙ…Ø§Ù„Ù‡Ù…)
                if (STATE.dailyTasks.length === 0) {
                    const daysRemaining = getDaysUntilExams();
                    const reviewTask = daysRemaining > 15 ? 
                        'Ù…Ø±Ø§Ø¬Ø¹Ø© Ø´Ø§Ù…Ù„Ø© ÙˆØ­Ù„ Ø£Ø³Ø¦Ù„Ø© Ø¹Ù„Ù‰ ÙˆØ­Ø¯ØªÙŠÙ†' : 
                        'Ø­Ù„ Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ù„Ø§Ù…ØªØ­Ø§Ù† Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ';
                        
                    STATE.dailyTasks.push({ 
                        id: `REVIEW_${todayFormatted}`, 
                        subject: allUncompletedLessons.length === 0 ? 'ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! (Ù…Ø±Ø§Ø¬Ø¹Ø©)' : 'Ù…Ù‡Ù…Ø© Ù…Ø±Ø§Ø¬Ø¹Ø©', 
                        lesson: allUncompletedLessons.length === 0 ? 'Ù„Ù‚Ø¯ Ø£Ù†Ù‡ÙŠØª Ø§Ù„Ù…Ù†Ù‡Ø¬! Ø±ÙƒØ² Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø¢Ù†.' : reviewTask, 
                        isCompleted: false 
                    });
                }

                STATE.lastScheduleDate = todayFormatted;
                saveData(); 
            }
        }

        // --- Timer Functions ---

        function formatTime(seconds) {
            const m = Math.floor(seconds / 60);
            const s = Math.floor(seconds % 60);
            return `${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;
        }
        
        function startTimer() {
            if (STATE.timer.isRunning) return;

            STATE.timer.isRunning = true;
            document.getElementById('timer-btn').innerHTML = `<i data-lucide="pause-circle" class="w-6 h-6 inline-block ml-2"></i> Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª`;
            lucide.createIcons();

            STATE.timer.intervalId = setInterval(() => {
                STATE.timer.remaining--;
                if (STATE.timer.remaining < 0) {
                    clearInterval(STATE.timer.intervalId);
                    completeSession();
                    return;
                }
                if (STATE.timer.isStudyMode) {
                    STATE.studyTimeToday++; 
                }
                updateUI();
            }, 1000);
        }

        function pauseTimer() {
            clearInterval(STATE.timer.intervalId);
            STATE.timer.isRunning = false;
            document.getElementById('timer-btn').innerHTML = `<i data-lucide="play" class="w-6 h-6 inline-block ml-2"></i> Ø¨Ø¯Ø¡ Ø§Ù„ØµØ±Ø§Ù…Ø©`;
            lucide.createIcons();
            saveData(); 
        }

        function completeSession() {
            const pointsGained = STATE.timer.isStudyMode ? 10 : 0;

            if (STATE.timer.isStudyMode) {
                STATE.currentAfirPoints += pointsGained;
                showModal(`ğŸ‰ ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ø£ÙƒÙ…Ù„Øª Ø¬Ù„Ø³Ø© 50 Ø¯Ù‚ÙŠÙ‚Ø© ØµØ±Ø§Ù…Ø©. ÙƒØ³Ø¨Øª ${pointsGained} Ù†Ù‚Ø·Ø© Ø¹Ø§ÙÙØ±!`);
                playSound('alert.mp3'); 
                
                STATE.timer.isStudyMode = false;
                STATE.timer.duration = 10 * 60;
                STATE.timer.remaining = 10 * 60;
                document.getElementById('timer-type').textContent = 'Ø§Ø³ØªØ±Ø§Ø­Ø© Ø¥Ø¬Ø¨Ø§Ø±ÙŠØ© (10 Ø¯Ù‚Ø§Ø¦Ù‚)';
            } else {
                showModal(`ğŸ”¥ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø±Ø§Ø­Ø©! Ø­Ø§Ù† ÙˆÙ‚Øª Ø§Ù„ØªØ±ÙƒÙŠØ² Ù…Ø¬Ø¯Ø¯Ø§Ù‹ Ø¹Ù„Ù‰ Ù‡Ø¯Ù YES Program.`);
                playSound('alert.mp3'); 
                
                STATE.timer.isStudyMode = true;
                STATE.timer.duration = 50 * 60;
                STATE.timer.remaining = 50 * 60;
                document.getElementById('timer-type').textContent = 'Ù…Ø¤Ù‚Øª Ø§Ù„ØµØ±Ø§Ù…Ø© (50 Ø¯Ù‚ÙŠÙ‚Ø© Ø¯Ø±Ø§Ø³Ø©)';
            }

            STATE.timer.isRunning = false;
            document.getElementById('timer-btn').innerHTML = `<i data-lucide="play" class="w-6 h-6 inline-block ml-2"></i> Ø¨Ø¯Ø¡ Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©`;
            lucide.createIcons();
            saveData();
            updateUI();
        }

        // --- UI Update Functions ---

        function getEgyptTimeAndDate() {
            const now = new Date();
            const time = now.toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true, timeZone: EGYPT_TIMEZONE });
            const date = now.toLocaleDateString('ar-EG', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', timeZone: EGYPT_TIMEZONE });
            return { time, date };
        }
        
        function getDaysUntilExams() {
            const now = new Date().toLocaleString("en-US", { timeZone: EGYPT_TIMEZONE });
            const today = new Date(now);
            const diffTime = EXAM_DATE.getTime() - today.getTime();
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            return diffDays > 0 ? diffDays : 0;
        }

        function calculateAchievedScore() {
            let achievedScore = 0;
            
            Object.keys(STATE.lessonsCompletionStatus).forEach(key => {
                if (STATE.lessonsCompletionStatus[key].completed) {
                    achievedScore += STATE.lessonsCompletionStatus[key].points;
                }
            });

            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª Ø§Ù„Ù…Ø­Ù‚Ù‚Ø© Ø¥Ù„Ù‰ Ù…Ø¬Ù…ÙˆØ¹ ÙØ¹Ù„ÙŠ (110 Ù†Ù‚Ø·Ø© ÙŠØªÙ… ØªØ­ÙˆÙŠÙ„Ù‡Ø§ Ø¥Ù„Ù‰ 280 Ø¯Ø±Ø¬Ø©)
            const finalAchievedScore = Math.min(Math.round(achievedScore / TOTAL_MAX_SCORE * 280), 280); 
            
            return { achievedScore: finalAchievedScore, totalPossibleScore: 280 };
        }

        function getMotivationalQuote(daysRemaining) {
            const now = new Date().toLocaleString("en-US", { timeZone: EGYPT_TIMEZONE });
            const nowEgypt = new Date(now);
            const currentHour = parseInt(nowEgypt.toLocaleTimeString('en-US', { hour: '2-digit', hour12: false, timeZone: EGYPT_TIMEZONE }));

            let quote = `Ù„Ø§ ØªØ³ØªØ³Ù„Ù…ØŒ Ù‡Ù„ ØªØªØ°ÙƒØ± Ù‡Ø¯Ù YES ProgramØŸ Ø¨Ø§Ù‚ÙŠ ${daysRemaining} ÙŠÙˆÙ… ÙÙ‚Ø· Ø¹Ù„Ù‰ Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª!`;
            let icon = 'zap'; 
            let color = 'text-gray-700';

            const studyStartHour = parseInt(STATE.schedule.studyStart.split(':')[0]);
            const studyEndHour = parseInt(STATE.schedule.studyEnd.split(':')[0]);
            
            if (currentHour >= studyStartHour && currentHour < studyEndHour) {
                // *** ÙˆÙ‚Øª Ø§Ù„Ø¯Ø±Ø§Ø³Ø© ***
                quote = `ğŸ”¥ Ø­Ø§Ù† ÙˆÙ‚Øª Ø§Ù„ØµØ±Ø§Ù…Ø©! Ø£Ù†Øª Ø§Ù„Ø¢Ù† ÙÙŠ ÙØªØ±Ø© Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù…Ø­Ø¯Ù‘Ø¯Ø© (${STATE.schedule.studyStart} - ${STATE.schedule.studyEnd}). Ø§Ù„ØªØ²Ù… Ø¨Ù…Ø¤Ù‚Øª 50/10 ÙˆØ§Ù†Ù‡Ù Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ….`;
                icon = 'book-open';
                color = 'text-green-700';
            } else if (currentHour >= parseInt(STATE.schedule.play.split(':')[0]) && currentHour < studyStartHour) {
                // *** ÙˆÙ‚Øª Ø§Ù„Ù„Ø¹Ø¨/Ø§Ù„Ø±Ø§Ø­Ø© ***
                quote = `ğŸ§˜â€â™‚ï¸ Ù‡Ø°Ø§ Ù‡Ùˆ ÙˆÙ‚Øª Ø§Ù„Ø±Ø§Ø­Ø© ÙˆØ§Ù„Ù„Ø¹Ø¨! Ø§Ø³ØªØ±Ø®ÙŠ ØªÙ…Ø§Ù…Ø§Ù‹ØŒ ÙˆØ¬Ø¯Ù‘Ø¯ Ø·Ø§Ù‚ØªÙƒØŒ ÙˆØ§Ø³ØªØ¹Ø¯ Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© ÙÙŠ ØªÙ…Ø§Ù… ${STATE.schedule.studyStart}.`;
                icon = 'gamepad-2';
                color = 'text-blue-700';
            } else if (currentHour >= parseInt(STATE.schedule.sleep.split(':')[0]) || currentHour < 6) {
                // *** ÙˆÙ‚Øª Ø§Ù„Ù†ÙˆÙ… ***
                quote = `ğŸŒ™ ÙˆÙ‚Øª Ø§Ù„Ù†ÙˆÙ…! Ø§Ù„Ù†Ø¬Ø§Ø­ ÙŠØ¨Ø¯Ø£ Ø¨Ø¹Ù‚Ù„ Ù…Ø±ØªØ§Ø­ ÙˆØ¬Ø³Ù… Ù…Ø³ØªØ¹Ø¯. Ù„Ø§ ØªÙ†Ø³Ù Ø£Ù† ØªØ±ØªØ§Ø­ Ø¬ÙŠØ¯Ø§Ù‹ Ù„ØªØ¨Ø¯Ø£ "Ø±Ø­Ù„Ø© Ù†Ø¬Ø§Ø­" Ø§Ù„ØºØ¯ Ø¨Ù‚ÙˆØ©.`;
                icon = 'moon';
                color = 'text-red-700';
            } else if (currentHour >= parseInt(STATE.schedule.business.split(':')[0]) && currentHour < parseInt(STATE.schedule.play.split(':')[0])) {
                // *** ÙˆÙ‚Øª Ø§Ù„Ø¨Ø²Ù†Ø³/Ø§Ù„Ø¹Ù…Ù„ ***
                quote = `ğŸ’¼ ÙˆÙ‚Øª Ø§Ù„Ø¹Ù…Ù„/Ø§Ù„Ø¨Ø²Ù†Ø³! Ø§Ø³ØªØºÙ„ Ù‡Ø°Ø§ Ø§Ù„ÙˆÙ‚Øª Ø¨Ø°ÙƒØ§Ø¡ Ù„ØªØ·ÙˆÙŠØ± Ù…Ù‡Ø§Ø±Ø§ØªÙƒ Ø£Ùˆ Ø§Ù„Ù‚ÙŠØ§Ù… Ø¨Ø£Ø¹Ù…Ø§Ù„Ùƒ. Ø³ØªØ¨Ø¯Ø£ Ø§Ù„Ø±Ø§Ø­Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹ ÙÙŠ ${STATE.schedule.play}.`;
                icon = 'briefcase';
                color = 'text-yellow-700';
            } else {
                 quote = `ØµØ¨Ø§Ø­ Ø£Ùˆ Ø¸Ù‡ÙŠØ±Ø© Ø±Ø§Ø¦Ø¹Ø©! ØªØ°ÙƒÙ‘Ø± Ø£Ù† ØªÙƒÙˆÙ† Ù…Ù†ØªØ¬Ø§Ù‹ Ø­ØªÙ‰ ÙŠØ¨Ø¯Ø£ ÙˆÙ‚Øª Ø§Ù„Ù…Ø°Ø§ÙƒØ±Ø© Ø§Ù„Ø±Ø³Ù…ÙŠ ÙÙŠ ${STATE.schedule.studyStart}. Ø¨Ø§Ù‚ÙŠ ${daysRemaining} ÙŠÙˆÙ… ÙÙ‚Ø·.`;
            }

            return { quote, icon, color };
        }

        function updateUI() {
            
            // 1. Update Time and Exam Countdown
            const { time, date } = getEgyptTimeAndDate();
            document.getElementById('current-time').textContent = time;
            document.getElementById('current-date').textContent = date;
            
            const daysRemaining = getDaysUntilExams();
            document.getElementById('exam-countdown').textContent = daysRemaining.toLocaleString('ar-EG');
            
            const { quote, icon, color } = getMotivationalQuote(daysRemaining);
            document.getElementById('motivation-text').textContent = quote;
            document.getElementById('motivation-icon').innerHTML = `<i data-lucide="${icon}" class="w-8 h-8 ml-3 ${color}"></i>`;
            document.getElementById('motivation-icon-container').className = `text-5xl font-extrabold text-indigo-800 text-center flex items-center justify-center ${color}`;


            // 2. Update Timer & Metrics
            document.getElementById('timer-display').textContent = formatTime(STATE.timer.remaining);
            document.getElementById('afir-points').textContent = STATE.currentAfirPoints.toLocaleString('ar-EG');
            document.getElementById('study-time').textContent = Math.floor(STATE.studyTimeToday / 3600).toLocaleString('ar-EG');
            
            const scores = calculateAchievedScore();
            document.getElementById('achieved-score').textContent = scores.achievedScore.toLocaleString('ar-EG');
            document.getElementById('total-score').textContent = scores.totalPossibleScore.toLocaleString('ar-EG');

            // 3. Update Schedule Display 
            document.getElementById('sleep-time-display').textContent = STATE.schedule.sleep;
            document.getElementById('business-time-display').textContent = STATE.schedule.business;
            document.getElementById('play-time-display').textContent = STATE.schedule.play;
            document.getElementById('study-range-display').textContent = `${STATE.schedule.studyStart} - ${STATE.schedule.studyEnd}`;

            // 4. Update Daily Tasks
            const tasksContainer = document.getElementById('daily-tasks-container');
            tasksContainer.innerHTML = '';

            if (STATE.dailyTasks.length === 0) {
                tasksContainer.innerHTML = `<p class="text-gray-500 p-4 bg-gray-100 rounded-lg text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ø§Ù… Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„ÙŠÙˆÙ…. <i data-lucide="check-circle" class="w-5 h-5 inline-block text-green-500 mr-1"></i></p>`;
            } else {
                STATE.dailyTasks.forEach(task => {
                    const isCompleted = task.isCompleted;
                    const isReviewTask = task.id.startsWith('REVIEW');
                    const taskElement = document.createElement('label');
                    taskElement.className = `flex items-center justify-between p-4 rounded-xl shadow-sm cursor-pointer transition duration-300 ${isCompleted ? 'bg-green-100 border-l-8 border-green-500' : isReviewTask ? 'bg-yellow-100 border-l-8 border-yellow-500' : 'bg-white hover:bg-indigo-50 border-l-8 border-indigo-500'}`;
                    
                    taskElement.innerHTML = `
                        <div class="flex items-center">
                            <input type="checkbox" data-id="${task.id}" class="h-6 w-6 text-indigo-600 rounded-md focus:ring-indigo-500" ${isCompleted ? 'checked' : ''} onchange="toggleDailyTask(this)">
                            <div class="mr-4">
                                <p class="font-bold ${isCompleted ? 'text-gray-500 line-through' : 'text-gray-800'}">${task.lesson}</p>
                                <p class="text-sm ${isCompleted ? 'text-green-500' : 'text-indigo-600'}">${task.subject}</p>
                            </div>
                        </div>
                        <i data-lucide="${isReviewTask ? 'rotate-cw' : 'book-open'}" class="text-gray-400 w-5 h-5"></i>
                    `;
                    tasksContainer.appendChild(taskElement);
                });
            }

            // 5. Update Daily Report 
            const dailyReport = document.getElementById('daily-report-content');
            const tasksLeft = STATE.dailyTasks.filter(t => !t.isCompleted).length;
            const tasksCompleted = STATE.dailyTasks.filter(t => t.isCompleted).length;
            
            const timePerTask = 60; // 50 Ø¯Ø±Ø§Ø³Ø© + 10 Ø±Ø§Ø­Ø©
            const totalStudyMinutes = tasksLeft * timePerTask;
            const totalStudyHours = Math.ceil(totalStudyMinutes / 60);

            let reportHtml = `
                <p class="mb-2 text-lg text-gray-700 font-semibold">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙÙŠ ÙŠÙˆÙ… Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø±Ø­Ù„Ø© Ù†Ø¬Ø§Ø­Ùƒ!</p>
                
                <div class="bg-indigo-100 p-3 rounded-lg mb-4">
                    <p class="font-bold text-indigo-800 flex items-center mb-1">
                        <i data-lucide="clipboard-list" class="w-5 h-5 ml-2"></i> Ù…Ù„Ø®Øµ Ù…Ù‡Ù…Ø§Øª Ø§Ù„ÙŠÙˆÙ…:
                    </p>
                    <p class="text-indigo-700 mr-7 text-base">
                       **${tasksCompleted}** Ù…Ù‡Ù…Ø© Ù…ÙƒØªÙ…Ù„Ø©. Ø¨Ø§Ù‚ÙŠ **${tasksLeft}** Ù…Ù‡Ù…Ø© Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©.
                       <span class="block mt-1 text-sm text-red-600 font-medium">Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨: Ø­ÙˆØ§Ù„ÙŠ ${totalStudyHours} Ø³Ø§Ø¹Ø© (Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¤Ù‚Øª 50/10).</span>
                    </p>
                </div>

                <div class="bg-blue-100 p-3 rounded-lg">
                    <p class="font-bold text-blue-800 flex items-center mb-1">
                         <i data-lucide="target" class="w-5 h-5 ml-2"></i> Ø£ÙˆÙ‚Ø§Øª Ø§Ù„ØªØ±ÙƒÙŠØ² ÙˆØ§Ù„Ø±Ø§Ø­Ø©:
                    </p>
                    <ul class="text-blue-700 mr-7 list-disc list-inside space-y-1 text-sm">
                        <li>**Ø§Ù„Ø¯Ø±Ø§Ø³Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©:** ${STATE.schedule.studyStart} - ${STATE.schedule.studyEnd} (Ù‡Ø¯Ù Ø§Ù„ÙŠÙˆÙ…)</li>
                        <li>**Ø§Ù„Ø¹Ù…Ù„/Ø§Ù„Ø¨Ø²Ù†Ø³:** ${STATE.schedule.business}</li>
                        <li>**Ø§Ù„Ø±Ø§Ø­Ø©/Ø§Ù„Ù„Ø¹Ø¨:** ${STATE.schedule.play}</li>
                        <li>**Ø§Ù„Ù†ÙˆÙ…:** ${STATE.schedule.sleep}</li>
                    </ul>
                </div>
            `;
            dailyReport.innerHTML = reportHtml;
            
            lucide.createIcons(); 
        }

        
        window.toggleDailyTask = (checkbox) => {
            const taskId = checkbox.getAttribute('data-id');
            const taskIndex = STATE.dailyTasks.findIndex(t => t.id === taskId);
            
            const isAcademicTask = !taskId.startsWith('REVIEW');

            if (taskIndex !== -1) {
                const isCompleted = checkbox.checked;
                STATE.dailyTasks[taskIndex].isCompleted = isCompleted;
                
                if(isAcademicTask && STATE.lessonsCompletionStatus[taskId]) {
                    STATE.lessonsCompletionStatus[taskId].completed = isCompleted;
                }

                if (isCompleted) {
                    STATE.currentAfirPoints += 100; 
                    showModal(`ğŸ”¥ Ù…Ù…ØªØ§Ø²! Ø£Ù†Ù‡ÙŠØª Ù…Ù‡Ù…Ø© ${STATE.dailyTasks[taskIndex].lesson}. ÙƒØ³Ø¨Øª 100 Ù†Ù‚Ø·Ø© Ø¹Ø§ÙÙØ±!`);
                } else {
                    STATE.currentAfirPoints -= 50; 
                }
                
                if(STATE.dailyTasks.every(t => t.isCompleted)) {
                   showModal(`ğŸ‰ğŸ‰ Ø£Ø­Ø³Ù†Øª! Ù„Ù‚Ø¯ Ø£Ù†Ù‡ÙŠØª Ø¬Ù…ÙŠØ¹ Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ… ÙÙŠ Ø±Ø­Ù„Ø© Ù†Ø¬Ø§Ø­Ùƒ. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø§Ù„Ø¨Ø¯Ø¡ ÙÙŠ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø­Ø±Ø© Ø£Ùˆ Ø§Ù„Ø§Ø³ØªØ±Ø§Ø­Ø©. Ù…Ù‡Ø§Ù… Ø§Ù„ØºØ¯ Ø¬Ø§Ù‡Ø²Ø©.`);
                }

                saveData();
                updateUI();
            }
        };

        window.toggleTimer = () => {
            if (STATE.timer.isRunning) {
                pauseTimer();
            } else {
                startTimer();
            }
        };

        window.showModal = (message) => {
            const modal = document.getElementById('success-modal');
            document.getElementById('modal-message').textContent = message;
            modal.classList.remove('hidden');
        };
        
        window.closeModal = () => {
            document.getElementById('success-modal').classList.add('hidden');
        };

        // Initial setup
        window.onload = () => {
            initializeFirebase();
            setInterval(updateUI, 1000); 
            lucide.createIcons();
        };

    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap');
        body {
            font-family: 'Cairo', sans-serif;
            background-color: #eef2ff; 
        }
        .task-card, .schedule-card {
            transition: all 0.3s ease;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        .timer-glow {
             text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div id="success-modal" class="fixed inset-0 bg-black bg-opacity-60 hidden z-50 flex items-center justify-center backdrop-blur-sm">
        <div class="bg-white p-6 rounded-2xl shadow-2xl max-w-sm w-full text-center border-t-4 border-indigo-600">
            <h3 class="text-2xl font-black text-indigo-700 mb-4 flex items-center justify-center">
                <i data-lucide="zap" class="w-7 h-7 ml-2 text-yellow-500"></i> Ø±Ø³Ø§Ù„Ø© Ù‚ÙˆØ©
            </h3>
            <p id="modal-message" class="text-gray-700 mb-6 text-lg"></p>
            <button onclick="closeModal()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded-xl transition duration-200 shadow-md">
                ÙÙ‡Ù…ØªØŒ Ø³Ø£Ø³ØªÙ…Ø±!
            </button>
        </div>
    </div>

    <div class="max-w-6xl mx-auto">
        
        <header class="bg-white p-6 rounded-3xl shadow-xl mb-8 border-b-4 border-indigo-600">
            <div id="motivation-icon-container" class="text-5xl font-extrabold text-indigo-800 text-center flex items-center justify-center">
                <span id="motivation-icon">
                    <i data-lucide="rocket" class="w-8 h-8 ml-3 text-red-500"></i>
                </span>
                <span class="text-5xl font-extrabold text-indigo-800">Ø±Ø­Ù„Ø© Ù†Ø¬Ø§Ø­</span>
            </div>
            <p class="mt-4 text-xl text-gray-700 text-center font-semibold" id="motivation-text"></p>
        </header>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 text-center">
            
            <div class="bg-indigo-100 p-4 rounded-xl shadow-md">
                <p class="text-sm font-semibold text-indigo-700">Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ØªÙˆÙ‚ÙŠØª Ø§Ù„Ø­Ø§Ù„ÙŠ (Ù…ØµØ±)</p>
                <p class="text-2xl font-black text-indigo-900 mt-1" id="current-time"></p> 
                <p class="text-sm font-medium text-indigo-700" id="current-date"></p>
            </div>
            
            <div class="bg-red-100 p-4 rounded-xl shadow-md">
                <p class="text-sm font-semibold text-red-700">Ø¨Ø§Ù‚ÙŠ Ø¹Ù„Ù‰ Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ù†ØµÙ Ø§Ù„Ø¹Ø§Ù…</p>
                <p class="text-2xl font-black text-red-900 mt-1"><span id="exam-countdown">0</span> ÙŠÙˆÙ…</p>
                <p class="text-sm font-medium text-red-700">Ù‡ÙŠØ§ØŒ Ù„Ø§ ÙˆÙ‚Øª Ù„Ù„ØªØ¶ÙŠÙŠØ¹!</p>
            </div>
            
            <div class="bg-green-100 p-4 rounded-xl shadow-md">
                <p class="text-sm font-semibold text-green-700">Ø§Ù„Ø¯Ø±Ø¬Ø© Ø§Ù„Ù…Ø­Ù‚Ù‚Ø© Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†</p>
                <p class="text-2xl font-black text-green-900 mt-1"><span id="achieved-score">0</span> / <span id="total-score">280</span></p>
                <p class="text-sm font-medium text-green-700">ØªÙ‚ÙŠÙŠÙ…Ùƒ Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ</p>
            </div>

        </div>

        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            
            <div class="task-card bg-indigo-600 text-white p-6 rounded-2xl flex flex-col justify-between">
                <div class="flex items-center mb-2">
                    <i data-lucide="award" class="w-6 h-6 mr-2"></i>
                    <p class="text-lg opacity-90">Ù†Ù‚Ø§Ø· Ø¹Ø§ÙÙØ± (Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…)</p>
                </div>
                <p class="text-5xl font-black mt-1" id="afir-points">0</p>
            </div>

            <div class="task-card bg-white p-6 rounded-2xl border-2 border-green-500 flex flex-col justify-between">
                 <div class="flex items-center mb-2">
                    <i data-lucide="clock" class="w-6 h-6 mr-2 text-green-600"></i>
                    <p class="text-lg text-gray-700">Ø³Ø§Ø¹Ø§Øª Ø§Ù„ØªØ±ÙƒÙŠØ² Ø§Ù„ÙŠÙˆÙ…</p>
                </div>
                <p class="text-5xl font-black text-green-600 mt-1"><span id="study-time">0</span> Ø³</p>
            </div>
            
            <div class="task-card bg-red-700 text-white p-6 rounded-2xl flex flex-col items-center justify-center col-span-2">
                <p id="timer-type" class="text-xl font-bold opacity-90 mb-2">Ù…Ø¤Ù‚Øª Ø§Ù„ØµØ±Ø§Ù…Ø© (50 Ø¯Ù‚ÙŠÙ‚Ø© Ø¯Ø±Ø§Ø³Ø©)</p>
                <p class="text-8xl font-black mt-2 mb-4 timer-glow" id="timer-display">50:00</p>
                <button id="timer-btn" onclick="toggleTimer()" class="bg-indigo-400 hover:bg-indigo-500 text-white font-bold text-xl py-3 px-12 rounded-full shadow-2xl transition duration-200 flex items-center justify-center">
                    <i data-lucide="play" class="w-6 h-6 inline-block ml-2"></i> Ø¨Ø¯Ø¡ Ø§Ù„ØµØ±Ø§Ù…Ø©
                </button>
            </div>

        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            
            <div class="task-card bg-white p-6 rounded-2xl shadow-xl">
                 <h2 class="text-2xl font-black text-indigo-800 mb-4 border-b pb-2 flex items-center">
                    <i data-lucide="calendar-check" class="w-6 h-6 ml-2 text-indigo-600"></i> ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙŠÙˆÙ… ÙˆØ·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¹Ù…Ù„
                </h2>
                <div id="daily-report-content">
                    </div>
            </div>
            
            <div class="task-card bg-white p-6 rounded-2xl shadow-xl md:col-span-1">
                <h2 class="text-2xl font-black text-gray-800 mb-6 border-b pb-3 flex items-center">
                    <i data-lucide="list-checks" class="w-7 h-7 ml-2 text-red-500"></i> Ù…Ù‡Ù…Ø§Øª Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©
                </h2>
                <div id="daily-tasks-container" class="space-y-4">
                    <p class="text-center text-gray-500">Ø¬Ø§Ø±ÙŠ Ø­Ø³Ø§Ø¨ Ù…Ù‡Ø§Ù… Ø§Ù„ÙŠÙˆÙ…...</p>
                </div>
            </div>
            
            <div class="task-card bg-indigo-50 p-6 rounded-2xl shadow-xl">
                <h2 class="text-2xl font-black text-indigo-800 mb-4 border-b-2 border-indigo-300 pb-2 flex items-center">
                    <i data-lucide="anchor" class="w-6 h-6 ml-2 text-indigo-600"></i> Ù…ÙØ±Ø³ÙØ§Ø© Ø§Ù„ÙŠÙˆÙ… (Ø£ÙˆÙ‚Ø§ØªÙƒ)
                </h2>
                <p class="text-sm text-gray-600 mb-4">Ø§Ù„ØªØ²Ø§Ù…Ùƒ Ø¨Ù‡Ø°Ù‡ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª Ù‡Ùˆ Ø£Ø³Ø§Ø³ Ø±Ø­Ù„Ø© Ù†Ø¬Ø§Ø­Ùƒ:</p>
                
                <ul class="space-y-4">
                    <li class="flex justify-between items-center text-lg py-2 rounded-lg px-3 bg-red-100">
                        <span class="font-bold text-red-700 flex items-center"><i data-lucide="moon" class="w-5 h-5 ml-2"></i> Ø§Ù„Ù†ÙˆÙ…</span>
                        <span id="sleep-time-display" class="font-extrabold text-gray-800 text-xl">22:00</span>
                    </li>
                    <li class="flex justify-between items-center text-lg py-2 rounded-lg px-3 bg-yellow-100">
                        <span class="font-bold text-yellow-800 flex items-center"><i data-lucide="briefcase" class="w-5 h-5 ml-2"></i> Ø§Ù„Ø¹Ù…Ù„/Ø§Ù„Ø¨Ø²Ù†Ø³</span>
                        <span id="business-time-display" class="font-extrabold text-gray-800 text-xl">15:00</span>
                    </li>
                    <li class="flex justify-between items-center text-lg py-2 rounded-lg px-3 bg-blue-100">
                        <span class="font-bold text-blue-700 flex items-center"><i data-lucide="gamepad-2" class="w-5 h-5 ml-2"></i> Ø§Ù„Ø±Ø§Ø­Ø©/Ø§Ù„Ù„Ø¹Ø¨</span>
                        <span id="play-time-display" class="font-extrabold text-gray-800 text-xl">14:00</span>
                    </li>
                    <li class="flex justify-between items-center text-lg py-2 rounded-lg px-3 bg-green-100">
                        <span class="font-bold text-green-700 flex items-center"><i data-lucide="book-open" class="w-5 h-5 ml-2"></i> Ø§Ù„Ø¯Ø±Ø§Ø³Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</span>
                        <span id="study-range-display" class="font-extrabold text-gray-800 text-xl">18:00 - 21:00</span>
                    </li>
                </ul>
                <p class="mt-4 text-xs text-red-500 text-center">Ø§Ø³ØªØ®Ø¯Ù… Ù…Ø¤Ù‚Øª Ø§Ù„ØµØ±Ø§Ù…Ø© (50/10) ÙÙŠ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¯Ø±Ø§Ø³Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©.</p>
            </div>

        </div>
        
        <footer class="mt-12 text-center text-sm text-gray-500 border-t pt-4">
             <p>Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (Ù„Ù„Ø­ÙØ¸): <span class="font-mono text-gray-700" id="user-id-display">N/A</span></p>
        </footer>

    </div>
    
    <script type="module">
        // Ù‡Ø°Ø§ Ø§Ù„Ø¬Ø²Ø¡ ÙŠØªÙˆÙ„Ù‰ ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø±Ù‘Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('user-id-display').textContent = user.uid;
            } else {
                document.getElementById('user-id-display').textContent = 'User not signed in.';
            }
        });
    </script>
</body>
</html>
